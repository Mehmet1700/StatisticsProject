---
title: "Determinants of GDP per Capita Growth in the EU"
author: "Statistical Analysis"
date: "2026-01-18"
output: 
  html_document:
    toc: true
    toc_float: true
    toc_depth: 3
    number_sections: true
    theme: flatly
    highlight: tango
    code_folding: show
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  message = FALSE,
  warning = FALSE,
  fig.width = 10,
  fig.height = 6,
  fig.align = "center"
)
```

# Setup

This section loads the required R packages for data retrieval, manipulation, panel econometrics, and visualization.

```{r libraries}
library(eurostat)
library(tidyverse)
library(plm)
library(lmtest)
library(sandwich)
library(stargazer)
library(corrplot)
library(kableExtra)
library(scales)
library(moments)
```

# Data Sources

We use annual panel data from Eurostat for EU-27 countries covering the period 2013–2023.
The dataset includes information on GDP per capita, migration, unemployment, and investment.

> **Note on sample period:** Raw data are available for 2013–2023, but the final analysis sample covers 2014–2023. GDP per capita growth is computed as the log difference relative to the previous year, which requires lagged observations. As a result, growth rates for 2013 cannot be computed and these observations are excluded from the regression sample.

| Variable | Eurostat Code | Description |
|----------|---------------|-------------|
| GDP per capita | `sdg_08_10` | Real GDP per capita in PPS |
| Net Migration | `migr_netmigr` | Net migration (immigration - emigration) |
| Population | `demo_gind` | Total population |
| Unemployment | `une_rt_a` | Unemployment rate (% of active population) |
| Investment Rate | `sdg_08_11` | Gross fixed capital formation (% of GDP) |

# Theoretical Background and Hypotheses

This study examines the determinants of GDP per capita growth in the European Union, focusing on three key macroeconomic variables: unemployment, investment, and migration. Each variable is grounded in established economic theory, which informs the directional hypotheses tested in the empirical analysis.

## Theoretical Framework

**Unemployment and Economic Growth.** The negative relationship between unemployment and output growth is well-documented in macroeconomic literature, most notably through Okun's Law [@okun1962]. Okun observed that for every percentage point increase in unemployment above the natural rate, real GDP falls by approximately 2–3 percent. This relationship reflects the direct loss of productive capacity when labor resources remain idle, as well as indirect effects through reduced consumer spending and lower aggregate demand.

**Investment and Economic Growth.** The Solow-Swan neoclassical growth model [@solow1956] establishes investment as a fundamental driver of long-run economic growth. Higher rates of gross fixed capital formation expand the capital stock, increase labor productivity, and shift the economy toward a higher steady-state level of output per capita. In the short to medium run, investment also stimulates aggregate demand, reinforcing its positive effect on growth.

**Migration and Economic Growth.** The relationship between migration and economic growth is theoretically ambiguous. On the one hand, net immigration expands the labor force, increases productive capacity, and can alleviate demographic pressures associated with aging populations—effects emphasized in the endogenous growth literature [@romer1990]. On the other hand, large immigration inflows may depress wages in the short run, strain public services, or dilute capital per worker if investment does not keep pace. Empirical evidence across EU countries suggests that the labor supply and human capital effects tend to dominate, yielding a modest positive relationship between migration and growth, particularly in economies with flexible labor markets [@docquier2014].

## Hypotheses

Based on the theoretical considerations above, we formulate the following directional hypotheses:

> **H1 (Unemployment):** There is a negative relationship between unemployment rate and GDP per capita growth. Higher unemployment represents underutilized labor resources and reduced aggregate demand, both of which suppress output growth (Okun's Law).

> **H2 (Investment):** There is a positive relationship between gross fixed capital formation (as a share of GDP) and GDP per capita growth. Capital accumulation increases productive capacity and drives both short-run demand effects and long-run supply-side growth (Solow growth model).

> **H3 (Migration):** There is a positive relationship between net migration rate and GDP per capita growth. Despite theoretical ambiguity regarding the short-run effects of immigration, we hypothesize that labor force expansion and the demographic contributions of migrants outweigh any capital-dilution effects, yielding a net positive association with growth.

These hypotheses are tested using panel data methods that account for unobserved country heterogeneity and common time shocks.

### Summary of Testable Hypotheses

For clarity, the hypotheses tested in this analysis are:

- **H1:** Higher unemployment is negatively associated with GDP growth (based on Okun's Law).
- **H2:** Higher investment rates are positively associated with GDP growth (based on Solow Growth Model).
- **H3:** Net migration has a positive association with economic growth (through labor supply expansion).

# Data Preparation

This section retrieves raw data from Eurostat and processes each variable (GDP, migration, unemployment, investment) for subsequent analysis.

## GDP per Capita

```{r gdp-data}
gdp_pc <- get_eurostat(
id = "sdg_08_10",
time_format = "num"
) %>%
select(geo, TIME_PERIOD, values) %>%
rename(
time = TIME_PERIOD,
gdp_pc = values
) %>%
filter(time >= 2013, time <= 2023)
gdp_pc <- gdp_pc %>%
  distinct(geo, time, .keep_all = TRUE)
```

## Migration Data

```{r migration-data}
migration_raw <- get_eurostat(
  id = "migr_netmigr",
  time_format = "num"
)

migration <- migration_raw %>%
  select(geo, TIME_PERIOD, values) %>%
  rename(
    time = TIME_PERIOD,
    net_migration = values
  ) %>%
  filter(time >= 2013, time <= 2023)
migration <- migration %>%
  distinct(geo, time, .keep_all = TRUE)
```

```{r population}
population_raw <- get_eurostat(
  id = "demo_gind",
  time_format = "num"
)

population <- population_raw %>%
  select(geo, TIME_PERIOD, values) %>%
  rename(
    time = TIME_PERIOD,
    population = values
  ) %>%
  filter(time >= 2013, time <= 2023) %>%
  distinct(geo, time, .keep_all = TRUE)

```

```{r}
migration <- migration %>%
  left_join(population, by = c("geo", "time")) %>%
  mutate(
    migration_rate = 1000 * net_migration / population
  )
```

## Unemployment Data

```{r unemployment-data}
unemployment_raw <- get_eurostat(
id = "une_rt_a",
time_format = "num"
)

unemployment <- unemployment_raw %>%
filter(sex == "T", age == "Y15-74") %>%
select(geo, TIME_PERIOD, values) %>%
rename(
time = TIME_PERIOD,
unemployment_rate = values
) %>%
filter(time >= 2013, time <= 2023)
unemployment <- unemployment %>%
  distinct(geo, time, .keep_all = TRUE)
```

## Investment Data (Gross Fixed Capital Formation)

```{r investment-data}
investment_raw <- get_eurostat(
  id = "sdg_08_11",
  time_format = "num"
)

investment <- investment_raw %>%
  select(geo, TIME_PERIOD, values) %>%
  rename(
    time = TIME_PERIOD,
    investment_rate = values
  ) %>%
  filter(time >= 2013, time <= 2023) %>%
  distinct(geo, time, .keep_all = TRUE)
```

# Panel Construction

This section merges all variables into a unified panel dataset for the EU-27 countries and computes the dependent variable (GDP per capita growth).

## EU-27 Countries

```{r panel-construction}
eu27 <- c(
"AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE",
"EL","HU","IE","IT","LV","LT","LU","MT","NL","PL","PT",
"RO","SK","SI","ES","SE"
)

# Country names for better visualization
country_names <- c(
  "AT" = "Austria", "BE" = "Belgium", "BG" = "Bulgaria", "HR" = "Croatia",
  "CY" = "Cyprus", "CZ" = "Czechia", "DK" = "Denmark", "EE" = "Estonia",
  "FI" = "Finland", "FR" = "France", "DE" = "Germany", "EL" = "Greece",
  "HU" = "Hungary", "IE" = "Ireland", "IT" = "Italy", "LV" = "Latvia",
  "LT" = "Lithuania", "LU" = "Luxembourg", "MT" = "Malta", "NL" = "Netherlands",
  "PL" = "Poland", "PT" = "Portugal", "RO" = "Romania", "SK" = "Slovakia",
  "SI" = "Slovenia", "ES" = "Spain", "SE" = "Sweden"
)

panel_data <- gdp_pc %>%
  distinct(geo, time, .keep_all = TRUE) %>%
  filter(geo %in% eu27) %>%
  inner_join(
    migration %>% distinct(geo, time, .keep_all = TRUE) %>% filter(geo %in% eu27),
    by = c("geo", "time")
  ) %>%
  inner_join(
    unemployment %>% distinct(geo, time, .keep_all = TRUE) %>% filter(geo %in% eu27),
    by = c("geo", "time")
  ) %>%
  inner_join(
    investment %>% distinct(geo, time, .keep_all = TRUE) %>% filter(geo %in% eu27),
    by = c("geo", "time")
  ) %>%
  arrange(geo, time) %>%
  group_by(geo) %>%
  mutate(
    gdp_pc_growth = 100 * (log(gdp_pc) - log(dplyr::lag(gdp_pc))),
    country_name = country_names[geo]
  ) %>%
  ungroup() %>%
  filter(!is.na(gdp_pc_growth))
```

# Final Dataset Check

This section verifies the panel dimensions, checks for balance, and confirms the final sample structure before analysis.

```{r dataset-summary}
panel_data %>%
summarise(
countries = n_distinct(geo),
years = n_distinct(time),
observations = n()
)
```

```{r balance-check}
table(table(panel_data$geo))
```

```{r check}
panel_data %>%
  count(geo, name = "n_obs") %>%
  arrange(n_obs)
```

> **Note on panel balance:** The dataset is nearly balanced, with 26 of 27 countries contributing the full 10 years of observations (2014–2023). Bulgaria has 9 observations due to one missing year in the source data. This minor imbalance does not affect the validity of the panel estimators, as both Fixed Effects and Random Effects accommodate unbalanced panels. No observations are dropped or imputed to address this issue.


# Descriptive Statistics

This section presents summary statistics, variance decomposition (between vs. within), and correlation analysis to characterize the data before regression modeling.

## Summary Statistics

```{r descriptive-stats}
desc_stats <- panel_data %>%
  select(gdp_pc_growth, migration_rate, unemployment_rate, investment_rate) %>%
  pivot_longer(everything(), names_to = "Variable", values_to = "Value") %>%
  group_by(Variable) %>%
  summarise(
    N = n(),
    Mean = round(mean(Value, na.rm = TRUE), 2),
    SD = round(sd(Value, na.rm = TRUE), 2),
    Min = round(min(Value, na.rm = TRUE), 2),
    Q1 = round(quantile(Value, 0.25, na.rm = TRUE), 2),
    Median = round(median(Value, na.rm = TRUE), 2),
    Q3 = round(quantile(Value, 0.75, na.rm = TRUE), 2),
    Max = round(max(Value, na.rm = TRUE), 2),
    Skewness = round(moments::skewness(Value, na.rm = TRUE), 2),
    Kurtosis = round(moments::kurtosis(Value, na.rm = TRUE), 2),
    .groups = "drop"
  )

kable(desc_stats, caption = "Summary Statistics of Key Variables") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE) %>%
  footnote(general = "Skewness: 0 = symmetric; Kurtosis: 3 = normal distribution")
```

## Between vs. Within Variation

For panel data analysis, it's crucial to understand the decomposition of variance:

- **Between variation**: Differences across countries (cross-sectional)
- **Within variation**: Changes over time within each country (temporal)

```{r between-within-variation}
# Calculate overall, between, and within statistics
variance_decomp <- panel_data %>%
  select(geo, gdp_pc_growth, migration_rate, unemployment_rate, investment_rate) %>%
  pivot_longer(-geo, names_to = "Variable", values_to = "Value") %>%
  group_by(Variable) %>%
  summarise(
    `Overall Mean` = round(mean(Value, na.rm = TRUE), 2),
    `Overall SD` = round(sd(Value, na.rm = TRUE), 2),
    .groups = "drop"
  )

# Between variation (variation of country means)
between_var <- panel_data %>%
  group_by(geo) %>%
  summarise(
    gdp_pc_growth = mean(gdp_pc_growth, na.rm = TRUE),
    migration_rate = mean(migration_rate, na.rm = TRUE),
    unemployment_rate = mean(unemployment_rate, na.rm = TRUE),
    investment_rate = mean(investment_rate, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  pivot_longer(-geo, names_to = "Variable", values_to = "Value") %>%
  group_by(Variable) %>%
  summarise(
    `Between SD` = round(sd(Value, na.rm = TRUE), 2),
    .groups = "drop"
  )

# Within variation (variation around country means)
within_var <- panel_data %>%
  group_by(geo) %>%
  mutate(
    gdp_pc_growth_dm = gdp_pc_growth - mean(gdp_pc_growth, na.rm = TRUE),
    migration_rate_dm = migration_rate - mean(migration_rate, na.rm = TRUE),
    unemployment_rate_dm = unemployment_rate - mean(unemployment_rate, na.rm = TRUE),
    investment_rate_dm = investment_rate - mean(investment_rate, na.rm = TRUE)
  ) %>%
  ungroup() %>%
  summarise(
    gdp_pc_growth = sd(gdp_pc_growth_dm, na.rm = TRUE),
    migration_rate = sd(migration_rate_dm, na.rm = TRUE),
    unemployment_rate = sd(unemployment_rate_dm, na.rm = TRUE),
    investment_rate = sd(investment_rate_dm, na.rm = TRUE)
  ) %>%
  pivot_longer(everything(), names_to = "Variable", values_to = "Within SD") %>%
  mutate(`Within SD` = round(`Within SD`, 2))

# Combine all
var_decomp_table <- variance_decomp %>%
  left_join(between_var, by = "Variable") %>%
  left_join(within_var, by = "Variable")

kable(var_decomp_table, caption = "Variance Decomposition: Overall, Between, and Within") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE) %>%
  footnote(
    general = "Between SD: cross-country variation; Within SD: within-country (temporal) variation",
    general_title = "Note: "
  )
```

**Interpretation:**

- If **Between SD > Within SD**: Most variation is across countries → Random Effects may be appropriate
- If **Within SD > Between SD**: Most variation is over time → Fixed Effects can identify effects well

## Distribution of Variables

```{r distribution-boxplot, fig.height=6}
panel_data %>%
  select(gdp_pc_growth, migration_rate, unemployment_rate, investment_rate) %>%
  pivot_longer(everything(), names_to = "Variable", values_to = "Value") %>%
  ggplot(aes(x = Variable, y = Value, fill = Variable)) +
  geom_boxplot(alpha = 0.7, outlier.color = "red", outlier.shape = 1) +
  geom_jitter(width = 0.2, alpha = 0.1, size = 0.5) +
  facet_wrap(~ Variable, scales = "free", ncol = 2) +
  labs(
    title = "Distribution of Key Variables",
    subtitle = "Boxplots with individual observations",
    x = "",
    y = "Value"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    legend.position = "none",
    strip.text = element_text(face = "bold"),
    plot.title = element_text(face = "bold"),
    axis.text.x = element_blank()
  ) +
  scale_fill_brewer(palette = "Set2")
```

## Statistics by Country

```{r stats-by-country}
country_stats <- panel_data %>%
  group_by(Country = country_name) %>%
  summarise(
    `Years` = n(),
    `Avg GDP Growth` = round(mean(gdp_pc_growth, na.rm = TRUE), 2),
    `SD GDP Growth` = round(sd(gdp_pc_growth, na.rm = TRUE), 2),
    `Avg Migration Rate` = round(mean(migration_rate, na.rm = TRUE), 2),
    `Avg Unemployment` = round(mean(unemployment_rate, na.rm = TRUE), 2),
    `Avg Investment` = round(mean(investment_rate, na.rm = TRUE), 2),
    .groups = "drop"
  ) %>%
  arrange(desc(`Avg GDP Growth`))

kable(country_stats, caption = "Summary Statistics by Country (2014-2023)") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE) %>%
  scroll_box(height = "400px")
```

## Statistics by Year

```{r stats-by-year}
year_stats <- panel_data %>%
  group_by(Year = time) %>%
  summarise(
    Countries = n(),
    `Avg GDP Growth` = round(mean(gdp_pc_growth, na.rm = TRUE), 2),
    `SD GDP Growth` = round(sd(gdp_pc_growth, na.rm = TRUE), 2),
    `Avg Migration Rate` = round(mean(migration_rate, na.rm = TRUE), 2),
    `Avg Unemployment` = round(mean(unemployment_rate, na.rm = TRUE), 2),
    `Avg Investment` = round(mean(investment_rate, na.rm = TRUE), 2),
    .groups = "drop"
  )

kable(year_stats, caption = "Summary Statistics by Year (EU-27 Average)") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

**Notable observations:**

- **2020**: COVID-19 pandemic caused significant GDP decline across all countries
- **2021**: Strong recovery ("bounce-back effect")
- **2022**: Recovery continued despite energy crisis and inflation

## Correlation Matrix

```{r correlation-matrix, fig.height=6, fig.width=7}
cor_vars <- panel_data %>%
  select(gdp_pc_growth, migration_rate, unemployment_rate, investment_rate) %>%
  na.omit()

cor_matrix <- cor(cor_vars)

corrplot(cor_matrix, 
         method = "color", 
         type = "upper",
         addCoef.col = "black",
         tl.col = "black",
         tl.srt = 45,
         col = colorRampPalette(c("#D73027", "white", "#1A9850"))(100),
         title = "Correlation Matrix",
         mar = c(0, 0, 2, 0))
```

**Interpretation:** 
- Negative correlation between unemployment and GDP growth suggests that higher unemployment is associated with lower economic growth.
- Investment rate typically shows a positive correlation with GDP growth, reflecting the importance of capital formation.
- The relationship between migration and GDP growth can be examined further in the regression analysis.

# Data Visualization

This section provides graphical exploration of the data, including time series plots, cross-country comparisons, and scatter plots of bivariate relationships.

## GDP per Capita Growth Over Time

```{r gdp-growth-time, fig.height=8}
ggplot(panel_data, aes(x = time, y = gdp_pc_growth, color = country_name)) +
  geom_line(alpha = 0.7, linewidth = 0.8) +
  geom_point(size = 1.5, alpha = 0.6) +
  geom_hline(yintercept = 0, linetype = "dashed", color = "gray40", linewidth = 0.8) +
  labs(
    title = "GDP per Capita Growth in EU-27 Countries (2014-2023)",
    subtitle = "Annual percentage change (log difference × 100)",
    x = "Year",
    y = "GDP per Capita Growth (%)",
    color = "Country"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    legend.position = "right",
    legend.text = element_text(size = 8),
    plot.title = element_text(face = "bold")
  ) +
  scale_x_continuous(breaks = seq(2014, 2023, 1)) +
  scale_color_viridis_d(option = "turbo")
```

## EU-27 Average Trends

```{r avg-trends, fig.height=9}
avg_over_time <- panel_data %>%
  group_by(time) %>%
  summarise(
    `GDP Growth (%)` = mean(gdp_pc_growth, na.rm = TRUE),
    `Migration Rate (‰)` = mean(migration_rate, na.rm = TRUE),
    `Unemployment Rate (%)` = mean(unemployment_rate, na.rm = TRUE),
    `Investment Rate (% GDP)` = mean(investment_rate, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  pivot_longer(-time, names_to = "Variable", values_to = "Value")

ggplot(avg_over_time, aes(x = time, y = Value, color = Variable)) +
  geom_line(linewidth = 1.2) +
  geom_point(size = 3) +
  facet_wrap(~ Variable, scales = "free_y", ncol = 1) +
  labs(
    title = "EU-27 Average: Key Economic Indicators Over Time",
    subtitle = "Arithmetic mean across all 27 member states",
    x = "Year",
    y = "Value"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    legend.position = "none",
    strip.text = element_text(face = "bold", size = 11),
    plot.title = element_text(face = "bold")
  ) +
  scale_x_continuous(breaks = seq(2014, 2023, 1)) +
  scale_color_brewer(palette = "Set1")
```

## Average GDP Growth by Country

```{r avg-growth-country, fig.height=8}
avg_growth <- panel_data %>%
  group_by(geo, country_name) %>%
  summarise(
    avg_growth = mean(gdp_pc_growth, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  arrange(desc(avg_growth))

ggplot(avg_growth, aes(x = reorder(country_name, avg_growth), y = avg_growth, fill = avg_growth)) +
  geom_col() +
  coord_flip() +
  geom_hline(yintercept = mean(avg_growth$avg_growth), linetype = "dashed", color = "red", linewidth = 0.8) +
  scale_fill_gradient2(low = "#D73027", mid = "#FFFFBF", high = "#1A9850", midpoint = 0) +
  labs(
    title = "Average GDP per Capita Growth by Country (2014-2023)",
    subtitle = "Red dashed line = EU-27 average",
    x = "",
    y = "Average Annual GDP Growth (%)",
    fill = "Growth"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    legend.position = "none",
    plot.title = element_text(face = "bold")
  )
```

## Scatter Plots: Bivariate Relationships

### Migration Rate vs. GDP Growth

```{r scatter-migration, fig.height=6}
ggplot(panel_data, aes(x = migration_rate, y = gdp_pc_growth)) +
  geom_point(aes(color = country_name), alpha = 0.6, size = 2) +
  geom_smooth(method = "lm", se = TRUE, color = "black", linetype = "dashed", linewidth = 1) +
  geom_hline(yintercept = 0, linetype = "dotted", color = "gray50") +
  geom_vline(xintercept = 0, linetype = "dotted", color = "gray50") +
  labs(
    title = "Migration Rate vs. GDP per Capita Growth",
    subtitle = "Each point = one country-year observation; dashed line = OLS fit",
    x = "Migration Rate (per 1,000 inhabitants)",
    y = "GDP per Capita Growth (%)",
    color = "Country"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    legend.position = "right",
    legend.text = element_text(size = 7),
    plot.title = element_text(face = "bold")
  ) +
  scale_color_viridis_d(option = "turbo")
```

### Unemployment Rate vs. GDP Growth

```{r scatter-unemployment, fig.height=6}
ggplot(panel_data, aes(x = unemployment_rate, y = gdp_pc_growth)) +
  geom_point(aes(color = country_name), alpha = 0.6, size = 2) +
  geom_smooth(method = "lm", se = TRUE, color = "black", linetype = "dashed", linewidth = 1) +
  geom_hline(yintercept = 0, linetype = "dotted", color = "gray50") +
  labs(
    title = "Unemployment Rate vs. GDP per Capita Growth",
    subtitle = "Each point = one country-year observation; dashed line = OLS fit",
    x = "Unemployment Rate (%)",
    y = "GDP per Capita Growth (%)",
    color = "Country"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    legend.position = "right",
    legend.text = element_text(size = 7),
    plot.title = element_text(face = "bold")
  ) +
  scale_color_viridis_d(option = "turbo")
```

### Investment Rate vs. GDP Growth

```{r scatter-investment, fig.height=6}
ggplot(panel_data, aes(x = investment_rate, y = gdp_pc_growth)) +
  geom_point(aes(color = country_name), alpha = 0.6, size = 2) +
  geom_smooth(method = "lm", se = TRUE, color = "black", linetype = "dashed", linewidth = 1) +
  geom_hline(yintercept = 0, linetype = "dotted", color = "gray50") +
  labs(
    title = "Investment Rate vs. GDP per Capita Growth",
    subtitle = "Each point = one country-year observation; dashed line = OLS fit",
    x = "Investment Rate (% of GDP)",
    y = "GDP per Capita Growth (%)",
    color = "Country"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    legend.position = "right",
    legend.text = element_text(size = 7),
    plot.title = element_text(face = "bold")
  ) +
  scale_color_viridis_d(option = "turbo")
```

## Evolution of Key Variables: Selected Countries

To provide a more granular view of the data underlying the regression analysis, the figure below traces the temporal evolution of the three main explanatory variables—migration rate, unemployment rate, and investment rate—for ten representative EU economies. The selection spans core Western European economies (Germany, France, Netherlands), Southern European states (Spain, Italy, Portugal, Greece), Northern Europe (Sweden), Central-Eastern Europe (Poland), and a high-growth outlier (Ireland). This diversity captures the heterogeneity in economic structures and trajectories that motivates the panel data approach.

```{r variable-evolution-selected, fig.height=12, fig.width=12, fig.cap="Evolution of key explanatory variables and GDP per capita growth (2014–2023) for ten representative EU economies. Each panel displays one country; lines represent the migration rate (per 1,000 inhabitants), unemployment rate (%), and investment rate (% of GDP) on the left axis, with GDP per capita growth (%) shown on the right axis. The plot illustrates cross-country heterogeneity in variable trajectories and highlights common shocks such as the COVID-19 pandemic (2020–2021)."}
# Select representative countries across EU regions
selected_countries <- c("DE", "FR", "ES", "IT", "PL", "NL", "PT", "SE", "EL", "IE")
selected_names <- c(
  "DE" = "Germany", "FR" = "France", "ES" = "Spain", "IT" = "Italy",
  "PL" = "Poland", "NL" = "Netherlands", "PT" = "Portugal", "SE" = "Sweden",
  "EL" = "Greece", "IE" = "Ireland"
)

# Prepare data for plotting - use GDP growth rate (%) for consistency with Figure 7.1
evolution_data <- panel_data %>%
  filter(geo %in% selected_countries) %>%
  mutate(country_label = selected_names[geo]) %>%
  select(country_label, time, migration_rate, unemployment_rate, investment_rate, gdp_pc_growth)

# Separate data for explanatory variables
expl_vars_data <- evolution_data %>%
  select(country_label, time, migration_rate, unemployment_rate, investment_rate) %>%
  pivot_longer(
    cols = c(migration_rate, unemployment_rate, investment_rate),
    names_to = "Variable",
    values_to = "Value"
  ) %>%
  mutate(
    Variable = case_when(
      Variable == "migration_rate" ~ "Migration Rate (per 1,000)",
      Variable == "unemployment_rate" ~ "Unemployment Rate (%)",
      Variable == "investment_rate" ~ "Investment Rate (% of GDP)"
    ),
    Variable = factor(Variable, levels = c(
      "Migration Rate (per 1,000)",
      "Unemployment Rate (%)",
      "Investment Rate (% of GDP)"
    ))
  )

# GDP growth data for secondary axis
gdp_data <- evolution_data %>%
  select(country_label, time, gdp_pc_growth)

# Scaling for secondary axis: GDP growth typically ranges from -15 to +25
# Map to similar range as other variables (~0-30)
gdp_scale_factor <- 1  # GDP growth is already in percentage points, similar scale
gdp_shift <- 0  # No shift needed

# Create faceted line plot with dual axis
ggplot() +
  # Explanatory variables (left axis)
  geom_line(data = expl_vars_data, 
            aes(x = time, y = Value, color = Variable, linetype = Variable),
            linewidth = 1) +
  geom_point(data = expl_vars_data, 
             aes(x = time, y = Value, color = Variable),
             size = 2, alpha = 0.8) +
  # GDP growth (right axis)
  geom_line(data = gdp_data,
            aes(x = time, y = gdp_pc_growth),
            color = "#7B3294", linewidth = 1.2, alpha = 0.8) +
  geom_point(data = gdp_data,
             aes(x = time, y = gdp_pc_growth),
             color = "#7B3294", size = 2.5, shape = 17, alpha = 0.8) +
  geom_hline(yintercept = 0, linetype = "dashed", color = "gray40", linewidth = 0.5) +
  facet_wrap(~ country_label, ncol = 2, scales = "free_y") +
  scale_x_continuous(breaks = seq(2014, 2023, 2)) +
  scale_y_continuous(
    name = "Value (Migration, Unemployment, Investment)",
    sec.axis = sec_axis(
      ~ .,
      name = "GDP per Capita Growth (%)"
    )
  ) +
  scale_color_manual(
    values = c(
      "Migration Rate (per 1,000)" = "#2166AC",
      "Unemployment Rate (%)" = "#B2182B",
      "Investment Rate (% of GDP)" = "#1B7837"
    )
  ) +
  scale_linetype_manual(
    values = c(
      "Migration Rate (per 1,000)" = "solid",
      "Unemployment Rate (%)" = "dashed",
      "Investment Rate (% of GDP)" = "dotted"
    )
  ) +
  labs(
    title = "Evolution of Key Variables and GDP per Capita Growth (2014–2023)",
    subtitle = "Selected EU economies | Purple triangles: GDP per capita growth (%, right axis)",
    x = "Year",
    color = "Explanatory Variables",
    linetype = "Explanatory Variables"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    legend.position = "bottom",
    legend.title = element_text(face = "bold"),
    strip.text = element_text(face = "bold", size = 11),
    plot.title = element_text(face = "bold"),
    plot.subtitle = element_text(color = "gray40"),
    panel.grid.minor = element_blank(),
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.title.y.right = element_text(color = "#7B3294", face = "bold"),
    axis.text.y.right = element_text(color = "#7B3294")
  ) +
  guides(
    color = guide_legend(nrow = 1),
    linetype = guide_legend(nrow = 1)
  )
```

The figure reveals substantial cross-country heterogeneity in variable levels and trajectories. The COVID-19 shock (2020) is visible as a sharp GDP contraction followed by V-shaped recovery across all countries. These differences in levels and dynamics motivate the use of fixed effects to absorb time-invariant country characteristics.

# Econometric Analysis

This section estimates the panel regression models (Pooled OLS, Fixed Effects, Random Effects) to test the hypotheses regarding the determinants of GDP growth.

## Panel Data Setup

```{r panel-structure}
pdata <- pdata.frame(
  panel_data,
  index = c("geo", "time")
)
```

```{r panel-dimensions}
pdim(pdata)
```

## Pooled OLS Model

```{r pooled-ols}
pooled_ols <- plm(
  gdp_pc_growth ~ migration_rate + unemployment_rate + investment_rate,
  data = pdata,
  model = "pooling"
)

summary(pooled_ols)
```

## Fixed Effects Model

### Why Two-Way Fixed Effects?

The sample period 2014–2023 includes several major global shocks that affected all EU countries simultaneously:

- **COVID-19 pandemic (2020):** An unprecedented exogenous shock causing synchronized GDP contractions across the EU, followed by a strong rebound in 2021.
- **Energy crisis and inflation surge (2022):** The war in Ukraine triggered energy price spikes and inflationary pressures affecting all member states.
- **European debt crisis aftermath (2014–2015):** Lingering effects of the sovereign debt crisis, particularly in Southern Europe.

A one-way fixed effects model (controlling only for country heterogeneity) would attribute these common time shocks to the explanatory variables, leading to **omitted variable bias**. For instance, if unemployment rose across all countries in 2020 due to COVID-19 (a common shock), a one-way FE model might incorrectly estimate a spuriously strong negative relationship between unemployment and growth.

**Two-way fixed effects** address this by including both:

1. **Country fixed effects ($\alpha_i$):** Control for time-invariant country characteristics (institutions, geography, culture)
2. **Time fixed effects ($\lambda_t$):** Control for year-specific shocks common to all countries (COVID-19, energy crisis, EU-wide policies)

The model specification becomes:
$$\text{GDP Growth}_{it} = \beta_1 \text{Migration}_{it} + \beta_2 \text{Unemployment}_{it} + \beta_3 \text{Investment}_{it} + \alpha_i + \lambda_t + \varepsilon_{it}$$

This ensures that the coefficients $\beta$ capture only the within-country, within-year variation in the explanatory variables—purged of both country-specific and time-specific confounders.

### One-Way Fixed Effects (Country Only)

For comparison, we first estimate the one-way FE model:

```{r fe-oneway}
fe_model_oneway <- plm(
  gdp_pc_growth ~ migration_rate + unemployment_rate + investment_rate,
  data = pdata,
  model = "within",
  effect = "individual"
)

summary(fe_model_oneway)
```

### Two-Way Fixed Effects (Country + Time)

```{r fe}
fe_model <- plm(
  gdp_pc_growth ~ migration_rate + unemployment_rate + investment_rate,
  data = pdata,
  model = "within",
  effect = "twoways"
)

summary(fe_model)
```

### Test for Significance of Time Effects

To formally test whether time fixed effects are necessary, we compare the two-way FE model against the one-way FE model:

- **H0:** Time effects are jointly zero (one-way FE is adequate)
- **H1:** Time effects are significant (two-way FE is needed)

```{r f-test-time}
f_test_time <- pFtest(fe_model, fe_model_oneway)
f_test_time
```

```{r f-test-time-interpretation, echo=FALSE}
if (f_test_time$p.value < 0.05) {
  cat("**Interpretation:** The F-test for time effects is significant (p =", format(f_test_time$p.value, scientific = TRUE, digits = 3), 
      "). Time fixed effects are jointly significant.\n",
      "The two-way FE model is preferred, confirming that common shocks (e.g., COVID-19) must be controlled for.")
} else {
  cat("**Interpretation:** The F-test for time effects is not significant (p =", round(f_test_time$p.value, 4), 
      "). Time fixed effects are not jointly significant.\n",
      "The one-way FE model may be adequate, though the two-way specification remains more conservative.")
}
```

## Random Effects Model

The Random Effects model assumes that country-specific effects are uncorrelated with the regressors and can be treated as random draws from a population distribution. This allows for more efficient estimation when the assumption holds.

> **Note on two-way Random Effects:** While the Fixed Effects model above uses a two-way specification (country + time), the standard Random Effects estimator in `plm` defaults to one-way (individual) effects. Two-way RE models are less commonly implemented and require additional assumptions. For the Hausman test comparison, we use the one-way RE model, acknowledging that this is a limitation. If the Hausman test rejects RE in favor of FE, the two-way FE model remains the preferred specification.

```{r re}
re_model <- plm(
  gdp_pc_growth ~ migration_rate + unemployment_rate + investment_rate,
  data = pdata,
  model = "random"
)

summary(re_model)
```

# Diagnostic Tests

This section conducts the standard specification tests to guide model selection.

## Breusch-Pagan LM Test: RE vs. Pooled OLS

The Breusch-Pagan Lagrange Multiplier test examines whether there are significant individual effects that justify using Random Effects over Pooled OLS.

- **H0**: No individual effects (Pooled OLS is adequate)
- **H1**: Significant individual effects (Random Effects is needed)

```{r bp-lm-test}
bp_lm_test <- plmtest(pooled_ols, type = "bp")
bp_lm_test
```

```{r bp-lm-interpretation, echo=FALSE}
if (bp_lm_test$p.value < 0.05) {
  cat("**Interpretation:** The BP-LM test is significant (p =", round(bp_lm_test$p.value, 4), 
      "). We reject H0 and conclude that individual effects are present.\n",
      "Pooled OLS is inappropriate; a panel model (FE or RE) should be used.")
} else {
  cat("**Interpretation:** The BP-LM test is not significant (p =", round(bp_lm_test$p.value, 4), 
      "). We fail to reject H0.\n",
      "Pooled OLS may be adequate, as no significant individual effects are detected.")
}
```

## Step 1: Test for Heteroskedasticity

Before conducting the Hausman test, we must first diagnose whether heteroskedasticity is present in the data. This is critical because the validity of the standard Hausman test depends on the assumption of homoskedastic errors.

- **H0**: Homoskedasticity (constant variance of errors)
- **H1**: Heteroskedasticity (non-constant variance of errors)

```{r bp-heteroskedasticity}
bp_hetero_test <- bptest(fe_model, data = pdata, studentize = TRUE)
bp_hetero_test
```

```{r bp-hetero-interpretation, echo=FALSE}
if (bp_hetero_test$p.value < 0.05) {
  cat("**Interpretation:** The Breusch-Pagan test rejects the null hypothesis of homoskedasticity (p =", 
      round(bp_hetero_test$p.value, 4), ").\n",
      "This implies that standard errors and the standard Hausman test statistic may be biased.\n",
      "We must therefore use a **Robust Hausman test** that accounts for heteroskedasticity.")
} else {
  cat("**Interpretation:** The Breusch-Pagan test does not reject homoskedasticity (p =", 
      round(bp_hetero_test$p.value, 4), ").\n",
      "Standard errors and the standard Hausman test are valid.")
}
```

## Step 2: Hausman Tests (Standard vs. Robust)

The Hausman test examines whether the country-specific effects are correlated with the regressors.

- **H0**: Random effects model is consistent and efficient (use RE)
- **H1**: Fixed effects model is consistent (use FE)

### Standard Hausman Test

```{r hausman-standard}
hausman_test <- phtest(fe_model, re_model)
hausman_test
```

### Robust Hausman Test (Heteroskedasticity-Consistent)

```{r hausman-robust}
hausman_robust <- phtest(fe_model, re_model, vcov = vcovHC)
hausman_robust
```

```{r hausman-comparison, echo=FALSE}
cat("### Comparison of Hausman Test Results\n\n")
cat("| Test Version | Chi-Squared | P-Value | Decision |\n")
cat("|--------------|-------------|---------|----------|\n")
cat("| Standard     |", round(hausman_test$statistic, 3), "|", round(hausman_test$p.value, 4), "|", 
    ifelse(hausman_test$p.value < 0.05, "Reject H0 (Use FE)", "Fail to Reject (Use RE)"), "|\n")
cat("| Robust (vcovHC) |", round(hausman_robust$statistic, 3), "|", round(hausman_robust$p.value, 4), "|", 
    ifelse(hausman_robust$p.value < 0.05, "Reject H0 (Use FE)", "Fail to Reject (Use RE)"), "|\n")
```

```{r hausman-interpretation, echo=FALSE}
if (bp_hetero_test$p.value < 0.05) {
  cat("\n**Interpretation:** Since we detected heteroskedasticity in Step 1, the Standard Hausman test is theoretically invalid. ",
      "However, we show both for comparison. ")
  if (hausman_robust$p.value < 0.05) {
    cat("The **Robust Hausman test** (which accounts for heteroskedasticity) confirms that the ",
        "**Fixed Effects model** is preferred (p =", round(hausman_robust$p.value, 4), "< 0.05).")
  } else {
    cat("The **Robust Hausman test** (which accounts for heteroskedasticity) suggests that the ",
        "**Random Effects model** may be preferred (p =", round(hausman_robust$p.value, 4), ">= 0.05).")
  }
} else {
  cat("\n**Interpretation:** Since homoskedasticity was not rejected in Step 1, the Standard Hausman test is valid. ")
  if (hausman_test$p.value < 0.05) {
    cat("The test indicates that the **Fixed Effects model** is preferred (p =", round(hausman_test$p.value, 4), "< 0.05).")
  } else {
    cat("The test indicates that the **Random Effects model** is preferred (p =", round(hausman_test$p.value, 4), ">= 0.05).")
  }
}
```

## Step 3: Conclusion on Standard Errors

```{r se-conclusion, echo=FALSE}
if (bp_hetero_test$p.value < 0.05) {
  cat("Given the presence of heteroskedasticity detected in Step 1, all subsequent regression tables will utilize ",
      "**Cluster-Robust Standard Errors** (`vcovHC`) to ensure valid inference.\n\n",
      "The preferred model based on the Robust Hausman test is: **", 
      ifelse(hausman_robust$p.value < 0.05, "Fixed Effects", "Random Effects"), "**.", sep = "")
} else {
  cat("Since homoskedasticity was not rejected, standard errors are valid. However, as a conservative approach, ",
      "we may still report cluster-robust standard errors for robustness.\n\n",
      "The preferred model based on the Standard Hausman test is: **", 
      ifelse(hausman_test$p.value < 0.05, "Fixed Effects", "Random Effects"), "**.", sep = "")
}
```

## F-Test for Fixed Effects

Testing whether the fixed effects (country effects) are jointly significant compared to Pooled OLS:

- **H0**: All individual effects are zero (Pooled OLS is adequate)
- **H1**: Fixed effects are significant (FE is needed)

```{r f-test-fe}
f_test <- pFtest(fe_model, pooled_ols)
f_test
```

```{r f-test-interpretation, echo=FALSE}
if (f_test$p.value < 0.05) {
  cat("**Interpretation:** The F-test is significant (p =", format(f_test$p.value, scientific = TRUE, digits = 3), 
      "). Country-specific effects are jointly significant.\n",
      "Pooled OLS is inappropriate; we need to account for individual heterogeneity.")
} else {
  cat("**Interpretation:** The F-test is not significant (p =", round(f_test$p.value, 4), 
      "). Country-specific effects are not jointly significant.\n",
      "Pooled OLS may be adequate.")
}
```

## Summary of Diagnostic Tests

```{r diagnostic-summary}
# Determine preferred model based on heteroskedasticity-adjusted logic
if (bp_hetero_test$p.value < 0.05) {
  # Heteroskedasticity present: use robust Hausman
  preferred_model <- ifelse(hausman_robust$p.value < 0.05, "Fixed Effects", "Random Effects")
  hausman_used <- "Robust"
} else {
  # No heteroskedasticity: use standard Hausman
  preferred_model <- ifelse(hausman_test$p.value < 0.05, "Fixed Effects", "Random Effects")
  hausman_used <- "Standard"
}

diagnostic_results <- data.frame(
  Step = c("1", "2a", "2b", "3", "4"),
  Test = c("Breusch-Pagan (Heteroskedasticity)", 
           "Hausman - Standard (FE vs. RE)",
           "Hausman - Robust (FE vs. RE)",
           "Breusch-Pagan LM (RE vs. OLS)", 
           "F-Test (FE vs. OLS)"),
  Statistic = c(round(bp_hetero_test$statistic, 3),
                round(hausman_test$statistic, 3),
                round(hausman_robust$statistic, 3),
                round(bp_lm_test$statistic, 3),
                round(f_test$statistic, 3)),
  `P-Value` = c(round(bp_hetero_test$p.value, 4),
                round(hausman_test$p.value, 4),
                round(hausman_robust$p.value, 4),
                round(bp_lm_test$p.value, 4),
                format(f_test$p.value, scientific = TRUE, digits = 2)),
  Decision = c(ifelse(bp_hetero_test$p.value < 0.05, "Heteroskedasticity Present", "Homoskedastic"),
               ifelse(hausman_test$p.value < 0.05, "Use FE", "Use RE"),
               ifelse(hausman_robust$p.value < 0.05, "Use FE", "Use RE"),
               ifelse(bp_lm_test$p.value < 0.05, "Use Panel Model", "OLS OK"),
               ifelse(f_test$p.value < 0.05, "FE needed", "Pooled OK"))
)

kable(diagnostic_results, caption = "Summary of Diagnostic Tests (Logical Sequence)") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE) %>%
  column_spec(5, bold = TRUE) %>%
  row_spec(ifelse(bp_hetero_test$p.value < 0.05, 3, 2), background = "#e6f3ff")
```

```{r final-conclusion, echo=FALSE}
cat("### Final Model Selection\n\n")
cat("**Diagnostic Logic:**\n\n")
cat("1. **Heteroskedasticity Test (Step 1):** ", 
    ifelse(bp_hetero_test$p.value < 0.05, 
           "Rejected homoskedasticity → Standard errors may be biased.\n", 
           "Failed to reject homoskedasticity → Standard errors are valid.\n"))
cat("2. **Hausman Test (Step 2):** Based on Step 1, we rely on the **", hausman_used, " Hausman test**.\n", sep = "")
cat("3. **Conclusion:** The **", preferred_model, "** model is the preferred specification.\n\n", sep = "")

if (bp_hetero_test$p.value < 0.05) {
  cat("**Important:** Given the presence of heteroskedasticity, all regression inference should use ",
      "**Cluster-Robust Standard Errors** (`vcovHC`) to ensure valid hypothesis tests and confidence intervals.")
}
```

# Model Comparison

This section compares the three estimators (Pooled OLS, FE, RE) side-by-side.

```{r model-comparison, results='asis'}
stargazer(
  pooled_ols,
  fe_model,
  re_model,
  type = "html",
  title = "Panel Regression Results",
  dep.var.labels = "GDP per capita growth",
  column.labels = c("Pooled OLS", "Fixed Effects", "Random Effects")
)
```

# Results Interpretation

```{r results-interpretation, echo=FALSE, results='asis'}
# Extract coefficients from preferred model
if (preferred_model == "Fixed Effects") {
  mig_coef <- round(coef(fe_model)["migration_rate"], 3)
  unemp_coef <- round(coef(fe_model)["unemployment_rate"], 3)
  invest_coef <- round(coef(fe_model)["investment_rate"], 3)
  mig_pval <- summary(fe_model)$coefficients["migration_rate", "Pr(>|t|)"]
  unemp_pval <- summary(fe_model)$coefficients["unemployment_rate", "Pr(>|t|)"]
  invest_pval <- summary(fe_model)$coefficients["investment_rate", "Pr(>|t|)"]
} else {
  mig_coef <- round(coef(re_model)["migration_rate"], 3)
  unemp_coef <- round(coef(re_model)["unemployment_rate"], 3)
  invest_coef <- round(coef(re_model)["investment_rate"], 3)
  mig_pval <- summary(re_model)$coefficients["migration_rate", "Pr(>|t|)"]
  unemp_pval <- summary(re_model)$coefficients["unemployment_rate", "Pr(>|t|)"]
  invest_pval <- summary(re_model)$coefficients["investment_rate", "Pr(>|t|)"]
}

cat("## Coefficient Interpretation (", preferred_model, " Model)\n\n", sep = "")

cat("**Migration Rate:** β = ", mig_coef, sep = "")
if (mig_pval < 0.05) {
  cat(" (significant at 5% level). ", sep = "")
  if (mig_coef > 0) {
    cat("A 1 unit increase in net migration rate is associated with a ", mig_coef, " percentage point increase in GDP growth.\n\n", sep = "")
  } else {
    cat("A 1 unit increase in net migration rate is associated with a ", abs(mig_coef), " percentage point decrease in GDP growth.\n\n", sep = "")
  }
} else {
  cat(" (not significant). The migration-growth relationship is not statistically significant.\n\n")
}

cat("**Unemployment Rate:** β = ", unemp_coef, sep = "")
if (unemp_pval < 0.05) {
  cat(" (significant at 5% level). ", sep = "")
  if (unemp_coef < 0) {
    cat("A 1 percentage point increase in unemployment is associated with a ", abs(unemp_coef), " percentage point decrease in GDP growth. This is consistent with Okun's Law.\n\n", sep = "")
  } else {
    cat("A 1 percentage point increase in unemployment is associated with a ", unemp_coef, " percentage point increase in GDP growth.\n\n", sep = "")
  }
} else {
  cat(" (not significant). The unemployment-growth relationship is not statistically significant.\n\n")
}

cat("**Investment Rate:** β = ", invest_coef, sep = "")
if (invest_pval < 0.05) {
  cat(" (significant at 5% level). ", sep = "")
  if (invest_coef > 0) {
    cat("A 1 percentage point increase in investment rate is associated with a ", invest_coef, " percentage point increase in GDP growth. This aligns with the Solow growth model.\n\n", sep = "")
  } else {
    cat("A 1 percentage point increase in investment rate is associated with a ", abs(invest_coef), " percentage point decrease in GDP growth.\n\n", sep = "")
  }
} else {
  cat(" (not significant). The investment-growth relationship is not statistically significant.\n\n")
}
```

# Limitations

The results of this analysis should be interpreted with caution. Several limitations affect the validity of causal inference:

1. **Endogeneity and reverse causality:** The relationships between GDP growth and the explanatory variables (migration, unemployment, investment) are likely bidirectional. For example, GDP growth may attract migrants and stimulate investment, while simultaneously being affected by these factors. Fixed effects control for time-invariant country characteristics but do not address contemporaneous simultaneity.

2. **Structural breaks:** The sample period (2014–2023) includes the COVID-19 pandemic (2020–2021), which introduced extraordinary variation in GDP growth. While this variation aids statistical identification, the estimated relationships may be influenced by crisis-period dynamics.

3. **Omitted variables:** Important growth determinants such as human capital, trade openness, and institutional quality are not included in the model, potentially biasing the estimates.

Advanced econometric methods (such as instrumental variables or GMM) could address some of these concerns but are beyond the scope of this introductory analysis. The findings should therefore be interpreted as **statistical associations** rather than causal effects.

# Conclusion

```{r conclusion, echo=FALSE, results='asis'}
cat("## Summary\n\n")

cat("This analysis examined the determinants of GDP per capita growth in the EU-27 using panel data methods. The standard diagnostic tests guided model selection:\n\n")

cat("- The **Breusch-Pagan LM test** ", ifelse(bp_lm_test$p.value < 0.05, "rejected", "did not reject"), " the null hypothesis, suggesting that ", ifelse(bp_lm_test$p.value < 0.05, "individual effects are present and a panel model is appropriate", "pooled OLS may be adequate"), ".\n", sep = "")

cat("- The **Hausman test** ", ifelse(hausman_test$p.value < 0.05, "rejected", "did not reject"), " the null hypothesis, indicating that the **", preferred_model, "** model is preferred.\n", sep = "")

cat("- The **F-test** ", ifelse(f_test$p.value < 0.05, "confirmed", "did not confirm"), " the significance of country-specific fixed effects.\n\n", sep = "")

cat("## Main Findings\n\n")

cat("Based on the ", preferred_model, " model:\n\n", sep = "")

if (unemp_pval < 0.05 & unemp_coef < 0) {
  cat("- **Unemployment** has a significant **negative** relationship with GDP growth (β = ", unemp_coef, "), consistent with H1 and Okun's Law.\n", sep = "")
} else if (unemp_pval >= 0.05) {
  cat("- **Unemployment** does not show a statistically significant relationship with GDP growth.\n")
}

if (invest_pval < 0.05 & invest_coef > 0) {
  cat("- **Investment** has a significant **positive** relationship with GDP growth (β = ", invest_coef, "), consistent with H2 and the Solow model.\n", sep = "")
} else if (invest_pval >= 0.05) {
  cat("- **Investment** does not show a statistically significant relationship with GDP growth.\n")
}

if (mig_pval < 0.05) {
  cat("- **Migration** shows a significant relationship with GDP growth (β = ", mig_coef, ").\n", sep = "")
} else {
  cat("- **Migration** does not show a statistically significant relationship with GDP growth, meaning H3 is not supported by the data.\n")
}

cat("\nThese results should be interpreted as correlations rather than causal effects due to the limitations discussed above.\n")
```

---

# Appendix

## Data Sources

All data were retrieved from Eurostat:

- GDP per capita: [sdg_08_10](https://ec.europa.eu/eurostat/databrowser/view/sdg_08_10/default/table)
- Net migration: [migr_netmigr](https://ec.europa.eu/eurostat/databrowser/view/migr_netmigr/default/table)
- Population: [demo_gind](https://ec.europa.eu/eurostat/databrowser/view/demo_gind/default/table)
- Unemployment: [une_rt_a](https://ec.europa.eu/eurostat/databrowser/view/une_rt_a/default/table)
- Investment (GFCF): [sdg_08_11](https://ec.europa.eu/eurostat/databrowser/view/sdg_08_11/default/table)

## Export Data for Submission

```{r export-data}
save(panel_data, file = "eu_growth_panel.RData")

cat("Exported dataset: eu_growth_panel.RData\n")
cat("Observations:", nrow(panel_data), "\n")
cat("Countries:", n_distinct(panel_data$geo), "\n")
cat("Sample period: 2014-2023\n")
```
