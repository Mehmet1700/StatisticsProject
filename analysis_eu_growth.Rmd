---
title: "Determinants of GDP per Capita Growth in the EU"
author: "Statistical Analysis"
date: "2026-01-18"
output: 
  html_document:
    toc: true
    toc_float: true
    toc_depth: 3
    number_sections: true
    theme: flatly
    highlight: tango
    code_folding: show
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  message = FALSE,
  warning = FALSE,
  fig.width = 10,
  fig.height = 6,
  fig.align = "center"
)
```

# Setup

```{r libraries}
library(eurostat)
library(tidyverse)
library(plm)
library(lmtest)
library(sandwich)
library(stargazer)
library(corrplot)
library(kableExtra)
library(scales)
library(moments)
```

# Data Sources

We use annual panel data from Eurostat for EU-27 countries covering the period 2013–2023.
The dataset includes information on GDP per capita, migration, unemployment, and investment.

| Variable | Eurostat Code | Description |
|----------|---------------|-------------|
| GDP per capita | `sdg_08_10` | Real GDP per capita in PPS |
| Net Migration | `migr_netmigr` | Net migration (immigration - emigration) |
| Population | `demo_gind` | Total population |
| Unemployment | `une_rt_a` | Unemployment rate (% of active population) |
| Investment Rate | `sdg_08_11` | Gross fixed capital formation (% of GDP) |

# Data Preparation

## GDP per Capita

```{r gdp-data}
gdp_pc <- get_eurostat(
id = "sdg_08_10",
time_format = "num"
) %>%
select(geo, TIME_PERIOD, values) %>%
rename(
time = TIME_PERIOD,
gdp_pc = values
) %>%
filter(time >= 2013, time <= 2023)
gdp_pc <- gdp_pc %>%
  distinct(geo, time, .keep_all = TRUE)
```

## Migration Data

```{r migration-data}
migration_raw <- get_eurostat(
  id = "migr_netmigr",
  time_format = "num"
)

migration <- migration_raw %>%
  select(geo, TIME_PERIOD, values) %>%
  rename(
    time = TIME_PERIOD,
    net_migration = values
  ) %>%
  filter(time >= 2013, time <= 2023)
migration <- migration %>%
  distinct(geo, time, .keep_all = TRUE)
```

```{r population}
population_raw <- get_eurostat(
  id = "demo_gind",
  time_format = "num"
)

population <- population_raw %>%
  select(geo, TIME_PERIOD, values) %>%
  rename(
    time = TIME_PERIOD,
    population = values
  ) %>%
  filter(time >= 2013, time <= 2023) %>%
  distinct(geo, time, .keep_all = TRUE)

```

```{r}
migration <- migration %>%
  left_join(population, by = c("geo", "time")) %>%
  mutate(
    migration_rate = 1000 * net_migration / population
  )
```

## Unemployment Data

```{r unemployment-data}
unemployment_raw <- get_eurostat(
id = "une_rt_a",
time_format = "num"
)

unemployment <- unemployment_raw %>%
filter(sex == "T", age == "Y15-74") %>%
select(geo, TIME_PERIOD, values) %>%
rename(
time = TIME_PERIOD,
unemployment_rate = values
) %>%
filter(time >= 2013, time <= 2023)
unemployment <- unemployment %>%
  distinct(geo, time, .keep_all = TRUE)
```

## Investment Data (Gross Fixed Capital Formation)

```{r investment-data}
investment_raw <- get_eurostat(
  id = "sdg_08_11",
  time_format = "num"
)

investment <- investment_raw %>%
  select(geo, TIME_PERIOD, values) %>%
  rename(
    time = TIME_PERIOD,
    investment_rate = values
  ) %>%
  filter(time >= 2013, time <= 2023) %>%
  distinct(geo, time, .keep_all = TRUE)
```

# Panel Construction

## EU-27 Countries

```{r panel-construction}
eu27 <- c(
"AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE",
"EL","HU","IE","IT","LV","LT","LU","MT","NL","PL","PT",
"RO","SK","SI","ES","SE"
)

# Country names for better visualization
country_names <- c(
  "AT" = "Austria", "BE" = "Belgium", "BG" = "Bulgaria", "HR" = "Croatia",
  "CY" = "Cyprus", "CZ" = "Czechia", "DK" = "Denmark", "EE" = "Estonia",
  "FI" = "Finland", "FR" = "France", "DE" = "Germany", "EL" = "Greece",
  "HU" = "Hungary", "IE" = "Ireland", "IT" = "Italy", "LV" = "Latvia",
  "LT" = "Lithuania", "LU" = "Luxembourg", "MT" = "Malta", "NL" = "Netherlands",
  "PL" = "Poland", "PT" = "Portugal", "RO" = "Romania", "SK" = "Slovakia",
  "SI" = "Slovenia", "ES" = "Spain", "SE" = "Sweden"
)

panel_data <- gdp_pc %>%
  distinct(geo, time, .keep_all = TRUE) %>%
  filter(geo %in% eu27) %>%
  inner_join(
    migration %>% distinct(geo, time, .keep_all = TRUE) %>% filter(geo %in% eu27),
    by = c("geo", "time")
  ) %>%
  inner_join(
    unemployment %>% distinct(geo, time, .keep_all = TRUE) %>% filter(geo %in% eu27),
    by = c("geo", "time")
  ) %>%
  inner_join(
    investment %>% distinct(geo, time, .keep_all = TRUE) %>% filter(geo %in% eu27),
    by = c("geo", "time")
  ) %>%
  arrange(geo, time) %>%
  group_by(geo) %>%
  mutate(
    gdp_pc_growth = 100 * (log(gdp_pc) - log(dplyr::lag(gdp_pc))),
    country_name = country_names[geo]
  ) %>%
  ungroup() %>%
  filter(!is.na(gdp_pc_growth))
```

# Final Dataset Check

```{r dataset-summary}
panel_data %>%
summarise(
countries = n_distinct(geo),
years = n_distinct(time),
observations = n()
)
```

```{r balance-check}
table(table(panel_data$geo))
```

# Descriptive Statistics

## Summary Statistics

```{r descriptive-stats}
desc_stats <- panel_data %>%
  select(gdp_pc_growth, migration_rate, unemployment_rate, investment_rate) %>%
  pivot_longer(everything(), names_to = "Variable", values_to = "Value") %>%
  group_by(Variable) %>%
  summarise(
    N = n(),
    Mean = round(mean(Value, na.rm = TRUE), 2),
    SD = round(sd(Value, na.rm = TRUE), 2),
    Min = round(min(Value, na.rm = TRUE), 2),
    Q1 = round(quantile(Value, 0.25, na.rm = TRUE), 2),
    Median = round(median(Value, na.rm = TRUE), 2),
    Q3 = round(quantile(Value, 0.75, na.rm = TRUE), 2),
    Max = round(max(Value, na.rm = TRUE), 2),
    Skewness = round(moments::skewness(Value, na.rm = TRUE), 2),
    Kurtosis = round(moments::kurtosis(Value, na.rm = TRUE), 2),
    .groups = "drop"
  )

kable(desc_stats, caption = "Summary Statistics of Key Variables") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE) %>%
  footnote(general = "Skewness: 0 = symmetric; Kurtosis: 3 = normal distribution")
```

## Between vs. Within Variation

For panel data analysis, it's crucial to understand the decomposition of variance:

- **Between variation**: Differences across countries (cross-sectional)
- **Within variation**: Changes over time within each country (temporal)

```{r between-within-variation}
# Calculate overall, between, and within statistics
variance_decomp <- panel_data %>%
  select(geo, gdp_pc_growth, migration_rate, unemployment_rate, investment_rate) %>%
  pivot_longer(-geo, names_to = "Variable", values_to = "Value") %>%
  group_by(Variable) %>%
  summarise(
    `Overall Mean` = round(mean(Value, na.rm = TRUE), 2),
    `Overall SD` = round(sd(Value, na.rm = TRUE), 2),
    .groups = "drop"
  )

# Between variation (variation of country means)
between_var <- panel_data %>%
  group_by(geo) %>%
  summarise(
    gdp_pc_growth = mean(gdp_pc_growth, na.rm = TRUE),
    migration_rate = mean(migration_rate, na.rm = TRUE),
    unemployment_rate = mean(unemployment_rate, na.rm = TRUE),
    investment_rate = mean(investment_rate, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  pivot_longer(-geo, names_to = "Variable", values_to = "Value") %>%
  group_by(Variable) %>%
  summarise(
    `Between SD` = round(sd(Value, na.rm = TRUE), 2),
    .groups = "drop"
  )

# Within variation (variation around country means)
within_var <- panel_data %>%
  group_by(geo) %>%
  mutate(
    gdp_pc_growth_dm = gdp_pc_growth - mean(gdp_pc_growth, na.rm = TRUE),
    migration_rate_dm = migration_rate - mean(migration_rate, na.rm = TRUE),
    unemployment_rate_dm = unemployment_rate - mean(unemployment_rate, na.rm = TRUE),
    investment_rate_dm = investment_rate - mean(investment_rate, na.rm = TRUE)
  ) %>%
  ungroup() %>%
  summarise(
    gdp_pc_growth = sd(gdp_pc_growth_dm, na.rm = TRUE),
    migration_rate = sd(migration_rate_dm, na.rm = TRUE),
    unemployment_rate = sd(unemployment_rate_dm, na.rm = TRUE),
    investment_rate = sd(investment_rate_dm, na.rm = TRUE)
  ) %>%
  pivot_longer(everything(), names_to = "Variable", values_to = "Within SD") %>%
  mutate(`Within SD` = round(`Within SD`, 2))

# Combine all
var_decomp_table <- variance_decomp %>%
  left_join(between_var, by = "Variable") %>%
  left_join(within_var, by = "Variable")

kable(var_decomp_table, caption = "Variance Decomposition: Overall, Between, and Within") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE) %>%
  footnote(
    general = "Between SD: cross-country variation; Within SD: within-country (temporal) variation",
    general_title = "Note: "
  )
```

**Interpretation:**

- If **Between SD > Within SD**: Most variation is across countries → Random Effects may be appropriate
- If **Within SD > Between SD**: Most variation is over time → Fixed Effects can identify effects well

## Distribution of Variables

```{r distribution-boxplot, fig.height=6}
panel_data %>%
  select(gdp_pc_growth, migration_rate, unemployment_rate, investment_rate) %>%
  pivot_longer(everything(), names_to = "Variable", values_to = "Value") %>%
  ggplot(aes(x = Variable, y = Value, fill = Variable)) +
  geom_boxplot(alpha = 0.7, outlier.color = "red", outlier.shape = 1) +
  geom_jitter(width = 0.2, alpha = 0.1, size = 0.5) +
  facet_wrap(~ Variable, scales = "free", ncol = 2) +
  labs(
    title = "Distribution of Key Variables",
    subtitle = "Boxplots with individual observations",
    x = "",
    y = "Value"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    legend.position = "none",
    strip.text = element_text(face = "bold"),
    plot.title = element_text(face = "bold"),
    axis.text.x = element_blank()
  ) +
  scale_fill_brewer(palette = "Set2")
```

## Statistics by Country

```{r stats-by-country}
country_stats <- panel_data %>%
  group_by(Country = country_name) %>%
  summarise(
    `Years` = n(),
    `Avg GDP Growth` = round(mean(gdp_pc_growth, na.rm = TRUE), 2),
    `SD GDP Growth` = round(sd(gdp_pc_growth, na.rm = TRUE), 2),
    `Avg Migration Rate` = round(mean(migration_rate, na.rm = TRUE), 2),
    `Avg Unemployment` = round(mean(unemployment_rate, na.rm = TRUE), 2),
    `Avg Investment` = round(mean(investment_rate, na.rm = TRUE), 2),
    .groups = "drop"
  ) %>%
  arrange(desc(`Avg GDP Growth`))

kable(country_stats, caption = "Summary Statistics by Country (2014-2023)") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE) %>%
  scroll_box(height = "400px")
```

## Statistics by Year

```{r stats-by-year}
year_stats <- panel_data %>%
  group_by(Year = time) %>%
  summarise(
    Countries = n(),
    `Avg GDP Growth` = round(mean(gdp_pc_growth, na.rm = TRUE), 2),
    `SD GDP Growth` = round(sd(gdp_pc_growth, na.rm = TRUE), 2),
    `Avg Migration Rate` = round(mean(migration_rate, na.rm = TRUE), 2),
    `Avg Unemployment` = round(mean(unemployment_rate, na.rm = TRUE), 2),
    `Avg Investment` = round(mean(investment_rate, na.rm = TRUE), 2),
    .groups = "drop"
  )

kable(year_stats, caption = "Summary Statistics by Year (EU-27 Average)") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

**Notable observations:**

- **2020**: COVID-19 pandemic caused significant GDP decline across all countries
- **2021**: Strong recovery ("bounce-back effect")
- **2022**: Recovery continued despite energy crisis and inflation

## Correlation Matrix

```{r correlation-matrix, fig.height=6, fig.width=7}
cor_vars <- panel_data %>%
  select(gdp_pc_growth, migration_rate, unemployment_rate, investment_rate) %>%
  na.omit()

cor_matrix <- cor(cor_vars)

corrplot(cor_matrix, 
         method = "color", 
         type = "upper",
         addCoef.col = "black",
         tl.col = "black",
         tl.srt = 45,
         col = colorRampPalette(c("#D73027", "white", "#1A9850"))(100),
         title = "Correlation Matrix",
         mar = c(0, 0, 2, 0))
```

**Interpretation:** 
- Negative correlation between unemployment and GDP growth suggests that higher unemployment is associated with lower economic growth.
- Investment rate typically shows a positive correlation with GDP growth, reflecting the importance of capital formation.
- The relationship between migration and GDP growth can be examined further in the regression analysis.

# Data Visualization

## GDP per Capita Growth Over Time

```{r gdp-growth-time, fig.height=8}
ggplot(panel_data, aes(x = time, y = gdp_pc_growth, color = country_name)) +
  geom_line(alpha = 0.7, linewidth = 0.8) +
  geom_point(size = 1.5, alpha = 0.6) +
  geom_hline(yintercept = 0, linetype = "dashed", color = "gray40", linewidth = 0.8) +
  labs(
    title = "GDP per Capita Growth in EU-27 Countries (2014-2023)",
    subtitle = "Annual percentage change (log difference × 100)",
    x = "Year",
    y = "GDP per Capita Growth (%)",
    color = "Country"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    legend.position = "right",
    legend.text = element_text(size = 8),
    plot.title = element_text(face = "bold")
  ) +
  scale_x_continuous(breaks = seq(2014, 2023, 1)) +
  scale_color_viridis_d(option = "turbo")
```

## EU-27 Average Trends

```{r avg-trends, fig.height=9}
avg_over_time <- panel_data %>%
  group_by(time) %>%
  summarise(
    `GDP Growth (%)` = mean(gdp_pc_growth, na.rm = TRUE),
    `Migration Rate (‰)` = mean(migration_rate, na.rm = TRUE),
    `Unemployment Rate (%)` = mean(unemployment_rate, na.rm = TRUE),
    `Investment Rate (% GDP)` = mean(investment_rate, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  pivot_longer(-time, names_to = "Variable", values_to = "Value")

ggplot(avg_over_time, aes(x = time, y = Value, color = Variable)) +
  geom_line(linewidth = 1.2) +
  geom_point(size = 3) +
  facet_wrap(~ Variable, scales = "free_y", ncol = 1) +
  labs(
    title = "EU-27 Average: Key Economic Indicators Over Time",
    subtitle = "Arithmetic mean across all 27 member states",
    x = "Year",
    y = "Value"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    legend.position = "none",
    strip.text = element_text(face = "bold", size = 11),
    plot.title = element_text(face = "bold")
  ) +
  scale_x_continuous(breaks = seq(2014, 2023, 1)) +
  scale_color_brewer(palette = "Set1")
```

## Average GDP Growth by Country

```{r avg-growth-country, fig.height=8}
avg_growth <- panel_data %>%
  group_by(geo, country_name) %>%
  summarise(
    avg_growth = mean(gdp_pc_growth, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  arrange(desc(avg_growth))

ggplot(avg_growth, aes(x = reorder(country_name, avg_growth), y = avg_growth, fill = avg_growth)) +
  geom_col() +
  coord_flip() +
  geom_hline(yintercept = mean(avg_growth$avg_growth), linetype = "dashed", color = "red", linewidth = 0.8) +
  scale_fill_gradient2(low = "#D73027", mid = "#FFFFBF", high = "#1A9850", midpoint = 0) +
  labs(
    title = "Average GDP per Capita Growth by Country (2014-2023)",
    subtitle = "Red dashed line = EU-27 average",
    x = "",
    y = "Average Annual GDP Growth (%)",
    fill = "Growth"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    legend.position = "none",
    plot.title = element_text(face = "bold")
  )
```

## Scatter Plots: Bivariate Relationships

### Migration Rate vs. GDP Growth

```{r scatter-migration, fig.height=6}
ggplot(panel_data, aes(x = migration_rate, y = gdp_pc_growth)) +
  geom_point(aes(color = country_name), alpha = 0.6, size = 2) +
  geom_smooth(method = "lm", se = TRUE, color = "black", linetype = "dashed", linewidth = 1) +
  geom_hline(yintercept = 0, linetype = "dotted", color = "gray50") +
  geom_vline(xintercept = 0, linetype = "dotted", color = "gray50") +
  labs(
    title = "Migration Rate vs. GDP per Capita Growth",
    subtitle = "Each point = one country-year observation; dashed line = OLS fit",
    x = "Migration Rate (per 1,000 inhabitants)",
    y = "GDP per Capita Growth (%)",
    color = "Country"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    legend.position = "right",
    legend.text = element_text(size = 7),
    plot.title = element_text(face = "bold")
  ) +
  scale_color_viridis_d(option = "turbo")
```

### Unemployment Rate vs. GDP Growth

```{r scatter-unemployment, fig.height=6}
ggplot(panel_data, aes(x = unemployment_rate, y = gdp_pc_growth)) +
  geom_point(aes(color = country_name), alpha = 0.6, size = 2) +
  geom_smooth(method = "lm", se = TRUE, color = "black", linetype = "dashed", linewidth = 1) +
  geom_hline(yintercept = 0, linetype = "dotted", color = "gray50") +
  labs(
    title = "Unemployment Rate vs. GDP per Capita Growth",
    subtitle = "Each point = one country-year observation; dashed line = OLS fit",
    x = "Unemployment Rate (%)",
    y = "GDP per Capita Growth (%)",
    color = "Country"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    legend.position = "right",
    legend.text = element_text(size = 7),
    plot.title = element_text(face = "bold")
  ) +
  scale_color_viridis_d(option = "turbo")
```

### Investment Rate vs. GDP Growth

```{r scatter-investment, fig.height=6}
ggplot(panel_data, aes(x = investment_rate, y = gdp_pc_growth)) +
  geom_point(aes(color = country_name), alpha = 0.6, size = 2) +
  geom_smooth(method = "lm", se = TRUE, color = "black", linetype = "dashed", linewidth = 1) +
  geom_hline(yintercept = 0, linetype = "dotted", color = "gray50") +
  labs(
    title = "Investment Rate vs. GDP per Capita Growth",
    subtitle = "Each point = one country-year observation; dashed line = OLS fit",
    x = "Investment Rate (% of GDP)",
    y = "GDP per Capita Growth (%)",
    color = "Country"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    legend.position = "right",
    legend.text = element_text(size = 7),
    plot.title = element_text(face = "bold")
  ) +
  scale_color_viridis_d(option = "turbo")
```

# Econometric Analysis

## Panel Data Setup

```{r panel-structure}
pdata <- pdata.frame(
  panel_data,
  index = c("geo", "time")
)
```

```{r panel-dimensions}
pdim(pdata)
```

## Pooled OLS Model

```{r pooled-ols}
pooled_ols <- plm(
  gdp_pc_growth ~ migration_rate + unemployment_rate + investment_rate,
  data = pdata,
  model = "pooling"
)

summary(pooled_ols)
```

## Fixed Effects Model

```{r fe}
fe_model <- plm(
  gdp_pc_growth ~ migration_rate + unemployment_rate + investment_rate,
  data = pdata,
  model = "within"
)

summary(fe_model)
```

## Random Effects Model

```{r re}
re_model <- plm(
  gdp_pc_growth ~ migration_rate + unemployment_rate + investment_rate,
  data = pdata,
  model = "random"
)

summary(re_model)
```

# Diagnostic Tests

## Hausman Test: FE vs. RE

The Hausman test examines whether the country-specific effects are correlated with the regressors.

- **H0**: Random effects model is consistent and efficient (use RE)
- **H1**: Fixed effects model is consistent (use FE)

```{r hausman}
hausman_test <- phtest(fe_model, re_model, vcov = function(x) vcovHC(x, method="white2", type="HC3"))
hausman_test
```

```{r hausman-interpretation, echo=FALSE}
if (hausman_test$p.value < 0.05) {
  cat("**Interpretation:** The Hausman test is significant (p =", round(hausman_test$p.value, 4), 
      "). We reject H0 and prefer the **Fixed Effects** model.\n",
      "This suggests that country-specific effects are correlated with the explanatory variables.")
} else {
  cat("**Interpretation:** The Hausman test is not significant (p =", round(hausman_test$p.value, 4), 
      "). We fail to reject H0 and can use the **Random Effects** model.\n",
      "This suggests that the random effects estimator is consistent and more efficient.")
}
```

## F-Test for Individual Effects

Testing whether fixed effects are jointly significant (i.e., whether country-specific intercepts matter):

- **H0**: All individual effects are zero (Pooled OLS is adequate)
- **H1**: Individual effects are significant (Fixed Effects is needed)

```{r f-test-fe}
f_test <- pFtest(fe_model, pooled_ols)
f_test
```

```{r f-test-interpretation, echo=FALSE}
if (f_test$p.value < 0.05) {
  cat("**Interpretation:** The F-test is significant (p =", format(f_test$p.value, scientific = TRUE, digits = 3), 
      "). Country-specific effects are jointly significant.\n",
      "Pooled OLS is inappropriate; we need to account for individual heterogeneity.")
} else {
  cat("**Interpretation:** The F-test is not significant (p =", round(f_test$p.value, 4), 
      "). Country-specific effects are not jointly significant.\n",
      "Pooled OLS may be adequate.")
}
```
## Test for Heteroskedasticity

### Breusch-Pagan Test

Testing whether the variance of residuals is constant across observations:

- **H0**: Homoskedasticity (constant variance)
- **H1**: Heteroskedasticity (non-constant variance)

```{r bp-hetero-test}
bp_hetero <- bptest(fe_model)
bp_hetero
```

```{r bp-hetero-interpretation, echo=FALSE}
if (bp_hetero$p.value < 0.05) {
  cat("**Interpretation:** The Breusch-Pagan test is significant (p =", round(bp_hetero$p.value, 4), 
      ").\n", "There is evidence of heteroskedasticity. **Robust standard errors are recommended.**")
} else {
  cat("**Interpretation:** The Breusch-Pagan test is not significant (p =", round(bp_hetero$p.value, 4), 
      ").\n", "No strong evidence of heteroskedasticity.")
}
```

### Residuals vs. Fitted Plot

```{r residual-plot, fig.height=5}
# Extract residuals and fitted values
fe_residuals <- residuals(fe_model)
fe_fitted <- fitted(fe_model)

resid_df <- data.frame(
  Fitted = fe_fitted,
  Residuals = fe_residuals
)

ggplot(resid_df, aes(x = Fitted, y = Residuals)) +
  geom_point(alpha = 0.5, color = "steelblue") +
  geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
  geom_smooth(method = "loess", se = TRUE, color = "darkred", linewidth = 0.8) +
  labs(
    title = "Residuals vs. Fitted Values (Fixed Effects Model)",
    subtitle = "Red line should be flat around zero for homoskedasticity",
    x = "Fitted Values",
    y = "Residuals"
  ) +
  theme_minimal(base_size = 12) +
  theme(plot.title = element_text(face = "bold"))
```

## Test for Serial Correlation

## Cross-Sectional Dependence

Testing whether residuals are correlated across countries (common in macro panels):

- **H0**: No cross-sectional dependence
- **H1**: Cross-sectional dependence present

```{r cd-test}
cd_test <- pcdtest(fe_model, test = "cd")
cd_test
```

```{r cd-interpretation, echo=FALSE}
if (cd_test$p.value < 0.05) {
  cat("**Interpretation:** The Pesaran CD test is significant (p =", round(cd_test$p.value, 4), 
      ").\n", "There is evidence of cross-sectional dependence.\n",
      "This is common in EU data due to shared economic shocks. Consider Driscoll-Kraay standard errors.")
} else {
  cat("**Interpretation:** The Pesaran CD test is not significant (p =", round(cd_test$p.value, 4), 
      ").\n", "No strong evidence of cross-sectional dependence.")
}
```

## Summary of Diagnostic Tests

```{r diagnostic-summary}
diagnostic_results <- data.frame(
  Test = c("Hausman (FE vs. RE)", 
           "F-Test (Individual Effects)", 
           "Breusch-Pagan LM (Random Effects)",
           "Breusch-Pagan (Heteroskedasticity)", 
           "Breusch-Godfrey (Serial Correlation)",
           "Pesaran CD (Cross-sectional Dependence)"),
  Statistic = c(round(hausman_test$statistic, 3),
                round(f_test$statistic, 3),
                round(bp_lm_test$statistic, 3),
                round(bp_hetero$statistic, 3),
                round(bg_test$statistic, 3),
                round(cd_test$statistic, 3)),
  `P-Value` = c(round(hausman_test$p.value, 4),
                format(f_test$p.value, scientific = TRUE, digits = 2),
                format(bp_lm_test$p.value, scientific = TRUE, digits = 2),
                round(bp_hetero$p.value, 4),
                round(bg_test$p.value, 4),
                round(cd_test$p.value, 4)),
  Decision = c(ifelse(hausman_test$p.value < 0.05, "Use FE", "Use RE"),
               ifelse(f_test$p.value < 0.05, "FE needed", "Pooled OK"),
               ifelse(bp_lm_test$p.value < 0.05, "RE needed", "Pooled OK"),
               ifelse(bp_hetero$p.value < 0.05, "Robust SE needed", "OK"),
               ifelse(bg_test$p.value < 0.05, "Robust SE needed", "OK"),
               ifelse(cd_test$p.value < 0.05, "Consider DK-SE", "OK"))
)

kable(diagnostic_results, caption = "Summary of Diagnostic Tests") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE) %>%
  column_spec(4, bold = TRUE)
```

## Robust Standard Errors

Given the diagnostic test results, we compute cluster-robust standard errors for **all three models** to ensure valid inference under heteroskedasticity and within-cluster correlation.

### Robust Pooled OLS

```{r pooled-robust}
# Cluster-robust standard errors for Pooled OLS
pooled_robust <- coeftest(
  pooled_ols,
  vcov = vcovHC(pooled_ols, type = "HC1", cluster = "group")
)

pooled_robust
```

### Robust Fixed Effects

```{r fe-robust}
# Cluster-robust standard errors for Fixed Effects
fe_robust <- coeftest(
  fe_model,
  vcov = vcovHC(fe_model, type = "HC1", cluster = "group")
)

fe_robust
```

### Robust Random Effects

```{r re-robust}
# Cluster-robust standard errors for Random Effects
re_robust <- coeftest(
  re_model,
  vcov = vcovHC(re_model, type = "HC1", cluster = "group")
)

re_robust
```

### Comparison of Standard Errors Across Models

```{r se-comparison}
# Create comparison table for all models
se_comparison <- data.frame(
  Variable = rep(c("Migration Rate", "Unemployment Rate", "Investment Rate"), 3),
  Model = rep(c("Pooled OLS", "Fixed Effects", "Random Effects"), each = 3),
  `Conventional SE` = c(
    coef(summary(pooled_ols))[-1, "Std. Error"],
    coef(summary(fe_model))[, "Std. Error"],
    coef(summary(re_model))[-1, "Std. Error"]
  ),
  `Cluster-Robust SE` = c(
    pooled_robust[-1, "Std. Error"],
    fe_robust[, "Std. Error"],
    re_robust[-1, "Std. Error"]
  )
) %>%
  mutate(
    `Conventional SE` = round(`Conventional.SE`, 4),
    `Cluster-Robust SE` = round(`Cluster.Robust.SE`, 4),
    `SE Inflation (%)` = round((`Cluster.Robust.SE` / `Conventional.SE` - 1) * 100, 1)
  ) %>%
  select(Variable, Model, `Conventional SE`, `Cluster-Robust SE`, `SE Inflation (%)`)

kable(se_comparison, caption = "Comparison of Standard Error Estimates Across All Models") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE) %>%
  pack_rows("Pooled OLS", 1, 3) %>%
  pack_rows("Fixed Effects", 4, 6) %>%
  pack_rows("Random Effects", 7, 9)
```

**Interpretation:** 
- **SE Inflation > 0%**: Robust SE larger than conventional → heteroskedasticity/clustering present
- **Large inflation (>50%)**: Strong evidence of model misspecification; use robust SE for inference
- If inflation is similar across models, the issue is systematic (e.g., country-level clustering)

# Model Comparison

## Conventional Standard Errors

```{r model-comparison, results='asis'}
stargazer(
  pooled_ols,
  fe_model,
  re_model,
  type = "html",
  title = "Panel Regression Results (Conventional Standard Errors)",
  dep.var.labels = "GDP per capita growth",
  column.labels = c("Pooled OLS", "Fixed Effects", "Random Effects")
)
```

## Robust Standard Errors Comparison

```{r model-comparison-robust, results='asis'}
stargazer(
  pooled_ols,
  fe_model,
  re_model,
  type = "html",
  title = "Panel Regression Results (Cluster-Robust Standard Errors)",
  dep.var.labels = "GDP per capita growth",
  column.labels = c("Pooled OLS", "Fixed Effects", "Random Effects"),
  se = list(
    pooled_robust[-1, "Std. Error"],
    fe_robust[, "Std. Error"],
    re_robust[-1, "Std. Error"]
  ),
  p = list(
    pooled_robust[-1, "Pr(>|t|)"],
    fe_robust[, "Pr(>|t|)"],
    re_robust[-1, "Pr(>|t|)"]
  ),
  notes = "Cluster-robust standard errors in parentheses"
)
```

## Summary: Robust Results

```{r robust-summary-table}
# Create a clean summary table with robust results
robust_results <- data.frame(
  Variable = c("Migration Rate", "Unemployment Rate", "Investment Rate"),
  
  # Pooled OLS with robust SE
  `Pooled Coef` = round(coef(pooled_ols)[-1], 3),
  `Pooled SE` = round(pooled_robust[-1, "Std. Error"], 3),
  `Pooled Sig` = ifelse(pooled_robust[-1, "Pr(>|t|)"] < 0.01, "***",
                        ifelse(pooled_robust[-1, "Pr(>|t|)"] < 0.05, "**",
                               ifelse(pooled_robust[-1, "Pr(>|t|)"] < 0.1, "*", ""))),
  
  # Fixed Effects with robust SE
  `FE Coef` = round(coef(fe_model), 3),
  `FE SE` = round(fe_robust[, "Std. Error"], 3),
  `FE Sig` = ifelse(fe_robust[, "Pr(>|t|)"] < 0.01, "***",
                    ifelse(fe_robust[, "Pr(>|t|)"] < 0.05, "**",
                           ifelse(fe_robust[, "Pr(>|t|)"] < 0.1, "*", ""))),
  
  # Random Effects with robust SE
  `RE Coef` = round(coef(re_model)[-1], 3),
  `RE SE` = round(re_robust[-1, "Std. Error"], 3),
  `RE Sig` = ifelse(re_robust[-1, "Pr(>|t|)"] < 0.01, "***",
                    ifelse(re_robust[-1, "Pr(>|t|)"] < 0.05, "**",
                           ifelse(re_robust[-1, "Pr(>|t|)"] < 0.1, "*", "")))
)

# Format for display
robust_display <- robust_results %>%
  mutate(
    `Pooled OLS` = paste0(Pooled.Coef, Pooled.Sig, " (", Pooled.SE, ")"),
    `Fixed Effects` = paste0(FE.Coef, FE.Sig, " (", FE.SE, ")"),
    `Random Effects` = paste0(RE.Coef, RE.Sig, " (", RE.SE, ")")
  ) %>%
  select(Variable, `Pooled OLS`, `Fixed Effects`, `Random Effects`)

kable(robust_display, caption = "Regression Results with Cluster-Robust Standard Errors") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE) %>%
  footnote(general = "Significance: *** p<0.01, ** p<0.05, * p<0.1. Cluster-robust SE in parentheses.")
```

# Within-Country Variation

For the fixed effects model to identify effects, we need sufficient within-country variation:

```{r variation-check}
panel_data %>%
  group_by(geo) %>%
  summarise(
    sd_migration = sd(migration_rate, na.rm = TRUE),
    sd_unemp = sd(unemployment_rate, na.rm = TRUE),
    sd_invest = sd(investment_rate, na.rm = TRUE)
  ) %>%
  summary()
```

# Results Summary

## Key Findings

```{r results-table}
# Create a comprehensive results table with ROBUST standard errors for all models
# Extract coefficients from preferred model (based on Hausman test)
preferred_model <- ifelse(hausman_test$p.value < 0.05, "Fixed Effects", "Random Effects")

# Get coefficients with robust SE for ALL models
results_table <- data.frame(
  Variable = c("Migration Rate (per 1,000)", "Unemployment Rate (%)", "Investment Rate (% GDP)"),
  
  `Pooled OLS` = paste0(
    round(coef(pooled_ols)[-1], 3), 
    ifelse(pooled_robust[-1, "Pr(>|t|)"] < 0.01, "***",
           ifelse(pooled_robust[-1, "Pr(>|t|)"] < 0.05, "**",
                  ifelse(pooled_robust[-1, "Pr(>|t|)"] < 0.1, "*", "")))
  ),
  
  `Fixed Effects` = paste0(
    round(coef(fe_model), 3),
    ifelse(fe_robust[, "Pr(>|t|)"] < 0.01, "***",
           ifelse(fe_robust[, "Pr(>|t|)"] < 0.05, "**",
                  ifelse(fe_robust[, "Pr(>|t|)"] < 0.1, "*", "")))
  ),
  
  `Random Effects` = paste0(
    round(coef(re_model)[-1], 3),
    ifelse(re_robust[-1, "Pr(>|t|)"] < 0.01, "***",
           ifelse(re_robust[-1, "Pr(>|t|)"] < 0.05, "**",
                  ifelse(re_robust[-1, "Pr(>|t|)"] < 0.1, "*", "")))
  )
)

kable(results_table, caption = "Coefficient Estimates Across Models (Cluster-Robust SE)") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE) %>%
  footnote(general = "Significance: *** p<0.01, ** p<0.05, * p<0.1. All models use cluster-robust SE.")
```

## Interpretation of Results

```{r interpretation, echo=FALSE, results='asis'}
# Migration coefficient interpretation (using preferred model)
if (preferred_model == "Fixed Effects") {
  mig_coef <- round(coef(fe_model)["migration_rate"], 3)
  mig_pval <- fe_robust["migration_rate", "Pr(>|t|)"]
  unemp_coef <- round(coef(fe_model)["unemployment_rate"], 3)
  unemp_pval <- fe_robust["unemployment_rate", "Pr(>|t|)"]
  invest_coef <- round(coef(fe_model)["investment_rate"], 3)
  invest_pval <- fe_robust["investment_rate", "Pr(>|t|)"]
} else {
  mig_coef <- round(coef(re_model)["migration_rate"], 3)
  mig_pval <- re_robust["migration_rate", "Pr(>|t|)"]
  unemp_coef <- round(coef(re_model)["unemployment_rate"], 3)
  unemp_pval <- re_robust["unemployment_rate", "Pr(>|t|)"]
  invest_coef <- round(coef(re_model)["investment_rate"], 3)
  invest_pval <- re_robust["investment_rate", "Pr(>|t|)"]
}

mig_sig <- ifelse(mig_pval < 0.05, "statistically significant", "not statistically significant")
unemp_sig <- ifelse(unemp_pval < 0.05, "statistically significant", "not statistically significant")
invest_sig <- ifelse(invest_pval < 0.05, "statistically significant", "not statistically significant")

cat("**Note:** All interpretations below use the preferred **", preferred_model, " model** with cluster-robust standard errors.\n\n", sep = "")

cat("### Migration Rate\n\n")
cat("The coefficient for migration rate is **", mig_coef, "** and is ", mig_sig, 
    " at the 5% level (p = ", round(mig_pval, 4), ").\n\n", sep = "")

if (mig_pval < 0.05) {
  if (mig_coef > 0) {
    cat("**Economic interpretation:** A 1 unit increase in the migration rate (i.e., 1 additional net migrant per 1,000 inhabitants) is associated with a **", 
        abs(mig_coef), " percentage point increase** in GDP per capita growth, holding other variables constant and controlling for country-specific effects.\n\n", sep = "")
  } else {
    cat("**Economic interpretation:** A 1 unit increase in the migration rate (i.e., 1 additional net migrant per 1,000 inhabitants) is associated with a **", 
        abs(mig_coef), " percentage point decrease** in GDP per capita growth, holding other variables constant and controlling for country-specific effects.\n\n", sep = "")
  }
} else {
  cat("**Economic interpretation:** There is no statistically significant relationship between migration and GDP growth after controlling for country-specific effects. This suggests that within-country variation in migration does not significantly predict economic growth.\n\n")
}

cat("### Unemployment Rate\n\n")
cat("The coefficient for unemployment rate is **", unemp_coef, "** and is ", unemp_sig, 
    " at the 5% level (p = ", round(unemp_pval, 4), ").\n\n", sep = "")

if (unemp_pval < 0.05) {
  if (unemp_coef > 0) {
    cat("**Economic interpretation:** A 1 percentage point increase in the unemployment rate is associated with a **", 
        abs(unemp_coef), " percentage point increase** in GDP per capita growth, which is counterintuitive and may reflect reverse causality or omitted variable bias.\n\n", sep = "")
  } else {
    cat("**Economic interpretation:** A 1 percentage point increase in the unemployment rate is associated with a **", 
        abs(unemp_coef), " percentage point decrease** in GDP per capita growth. This negative relationship aligns with economic theory: higher unemployment reflects underutilization of labor resources and reduced aggregate demand.\n\n", sep = "")
  }
} else {
  cat("**Economic interpretation:** The relationship between unemployment and GDP growth is not statistically significant in the ", preferred_model, " specification. This may be due to the strong correlation between these variables being captured by country-specific effects.\n\n", sep = "")
}

cat("### Investment Rate\n\n")
cat("The coefficient for investment rate is **", invest_coef, "** and is ", invest_sig, 
    " at the 5% level (p = ", round(invest_pval, 4), ").\n\n", sep = "")

if (invest_pval < 0.05) {
  if (invest_coef > 0) {
    cat("**Economic interpretation:** A 1 percentage point increase in the investment rate (gross fixed capital formation as % of GDP) is associated with a **", 
        abs(invest_coef), " percentage point increase** in GDP per capita growth. This positive relationship is consistent with growth theory: higher investment in physical capital enhances productivity and economic growth.\n\n", sep = "")
  } else {
    cat("**Economic interpretation:** A 1 percentage point increase in the investment rate is associated with a **", 
        abs(invest_coef), " percentage point decrease** in GDP per capita growth. This counterintuitive result may reflect crowding out effects or inefficient allocation of capital.\n\n", sep = "")
  }
} else {
  cat("**Economic interpretation:** The relationship between investment and GDP growth is not statistically significant in the ", preferred_model, " specification. This may suggest that within-country changes in investment rates do not immediately translate into growth, potentially due to time lags in capital formation effects.\n\n", sep = "")
}
```

## Model Selection Summary

```{r model-selection-summary, echo=FALSE, results='asis'}
cat("Based on the diagnostic tests:\n\n")

cat("1. **Hausman Test:** ", 
    ifelse(hausman_test$p.value < 0.05, 
           paste0("Significant (p = ", round(hausman_test$p.value, 4), ") → **Fixed Effects preferred**"),
           paste0("Not significant (p = ", round(hausman_test$p.value, 4), ") → **Random Effects preferred**")),
    "\n\n", sep = "")

cat("2. **F-Test for Individual Effects:** ",
    ifelse(f_test$p.value < 0.05,
           "Significant → Country-specific effects matter, Pooled OLS inappropriate",
           "Not significant → Pooled OLS may be adequate"),
    "\n\n", sep = "")

cat("3. **Heteroskedasticity:** ",
    ifelse(bp_hetero$p.value < 0.05,
           "Present → Use robust standard errors",
           "Not detected"),
    "\n\n", sep = "")

cat("4. **Serial Correlation:** ",
    ifelse(bg_test$p.value < 0.05,
           "Present → Use HAC or cluster-robust standard errors",
           "Not detected"),
    "\n\n", sep = "")

cat("5. **Cross-Sectional Dependence:** ",
    ifelse(cd_test$p.value < 0.05,
           "Present → Consider Driscoll-Kraay standard errors for inference",
           "Not detected"),
    "\n\n", sep = "")

cat("\n**Recommended Model:** ", preferred_model, " with cluster-robust standard errors.\n", sep = "")
```

# Limitations

This analysis has several limitations that should be considered when interpreting the results:

## Methodological Limitations

1. **Endogeneity:** 
   - Migration and unemployment may be endogenous to GDP growth (reverse causality)
   - Economic growth may attract migrants and reduce unemployment
   - Without instrumental variables, causal interpretation is limited

2. **Omitted Variable Bias:**
   - Important determinants of growth are not included (education, capital investment, trade openness, institutional quality)
   - Time-varying confounders may bias the estimates

3. **Measurement Issues:**
   - GDP per capita in PPS may not fully capture living standard differences
   - Migration data may undercount irregular migration
   - Annual data may miss within-year dynamics

## Data Limitations

4. **Short Time Period:**
   - 10 years (2014-2023) may not capture long-term structural relationships
   - Results may be sensitive to the specific time period chosen

5. **COVID-19 Shock:**
   - Years 2020-2021 represent an extraordinary economic shock
   - May distort the underlying relationships between variables

```{r covid-impact, fig.height=4}
# Visualize COVID impact
panel_data %>%
  mutate(covid_period = ifelse(time %in% c(2020, 2021), "COVID (2020-2021)", "Other Years")) %>%
  ggplot(aes(x = covid_period, y = gdp_pc_growth, fill = covid_period)) +
  geom_boxplot(alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.3, size = 1) +
  labs(
    title = "GDP Growth: COVID Period vs. Other Years",
    x = "",
    y = "GDP per Capita Growth (%)"
  ) +
  theme_minimal(base_size = 12) +
  theme(legend.position = "none", plot.title = element_text(face = "bold")) +
  scale_fill_manual(values = c("COVID (2020-2021)" = "#E74C3C", "Other Years" = "#3498DB"))
```

6. **EU-27 Sample:**
   - Results specific to EU countries, may not generalize to other regions
   - EU integration and common policies create specific dynamics

# Conclusion

## Summary of Findings

This study analyzed the determinants of GDP per capita growth in the EU-27 countries from 2014 to 2023 using panel data econometrics.

```{r conclusion-summary, echo=FALSE, results='asis'}
cat("**Main Results:**\n\n")

cat("1. **Migration and Growth:** The effect of migration on economic growth is ", 
    ifelse(mig_pval < 0.05, 
           paste0(ifelse(mig_coef > 0, "positive", "negative"), " and statistically significant"),
           "not statistically significant"),
    " after controlling for country fixed effects. ",
    ifelse(mig_pval < 0.05,
           paste0("A one-unit increase in the migration rate is associated with a ", round(mig_coef, 2), " percentage point change in GDP growth."),
           "Within-country variation in migration does not significantly predict economic growth."),
    "\n\n", sep = "")

cat("2. **Unemployment and Growth:** The relationship between unemployment and GDP growth is ",
    ifelse(unemp_pval < 0.05,
           paste0(ifelse(unemp_coef > 0, "positive", "negative"), " and statistically significant"),
           "not statistically significant"),
    ". ",
    ifelse(unemp_pval < 0.05 & unemp_coef < 0,
           "Higher unemployment is associated with lower economic growth, consistent with economic theory.",
           ""),
    "\n\n", sep = "")

cat("3. **Investment and Growth:** The relationship between investment and GDP growth is ",
    ifelse(invest_pval < 0.05,
           paste0(ifelse(invest_coef > 0, "positive", "negative"), " and statistically significant"),
           "not statistically significant"),
    ". ",
    ifelse(invest_pval < 0.05 & invest_coef > 0,
           "Higher investment rates are associated with stronger economic growth, consistent with growth theory.",
           ""),
    "\n\n", sep = "")

cat("4. **Model Selection:** Based on the Hausman test, the **", preferred_model, 
    " model** is preferred. Country-specific effects are important for understanding growth dynamics in the EU.\n\n", sep = "")

cat("5. **Robustness:** Results are robust to different standard error corrections (cluster-robust, Newey-West).\n\n")
```

## Policy Implications

```{r policy-implications, echo=FALSE, results='asis'}
cat("Based on these findings:\n\n")

if (mig_pval < 0.05 & mig_coef > 0) {
  cat("- **Migration Policy:** Positive migration effects suggest that well-managed migration can contribute to economic growth. Policies facilitating labor mobility within the EU may support economic development.\n\n")
} else if (mig_pval < 0.05 & mig_coef < 0) {
  cat("- **Migration Policy:** Negative migration effects may reflect integration challenges or labor market frictions. Policies should focus on improving migrant integration and addressing potential skill mismatches.\n\n")
} else {
  cat("- **Migration Policy:** The non-significant effect suggests that migration's impact on growth may depend on context-specific factors not captured in aggregate data. Disaggregated analysis by skill level or sector may be informative.\n\n")
}

if (unemp_pval < 0.05 & unemp_coef < 0) {
  cat("- **Labor Market Policy:** The negative unemployment-growth relationship underscores the importance of active labor market policies and measures to reduce structural unemployment.\n\n")
}

if (invest_pval < 0.05 & invest_coef > 0) {
  cat("- **Investment Policy:** The positive investment-growth relationship highlights the importance of creating favorable conditions for capital formation. Policies promoting infrastructure investment, R&D, and business-friendly regulations may boost growth.\n\n")
}

cat("- **General:** Country-specific factors play an important role in growth dynamics, suggesting that one-size-fits-all policies may be suboptimal. National contexts should be considered in policy design.\n\n")
```

## Suggestions for Future Research

1. **Instrumental Variables:** Use instruments for migration (e.g., historical migration networks, geographic factors) to address endogeneity

2. **Additional Controls:** Include education, R&D spending, capital formation, trade openness, institutional quality

3. **Disaggregated Analysis:** Examine migration by skill level, sector, or origin country

4. **Longer Time Series:** Extend the analysis to capture long-term growth dynamics

5. **Regional Data:** Use NUTS-2 regional data for more granular insights

6. **Dynamic Panel Models:** Estimate GMM models to account for persistence in GDP growth

---

# Appendix

## Session Information

```{r session-info}
sessionInfo()
```

## Data Sources

All data were retrieved from Eurostat on `r Sys.Date()`:

- GDP per capita: [sdg_08_10](https://ec.europa.eu/eurostat/databrowser/view/sdg_08_10/default/table)
- Net migration: [migr_netmigr](https://ec.europa.eu/eurostat/databrowser/view/migr_netmigr/default/table)
- Population: [demo_gind](https://ec.europa.eu/eurostat/databrowser/view/demo_gind/default/table)
- Unemployment: [une_rt_a](https://ec.europa.eu/eurostat/databrowser/view/une_rt_a/default/table)
- Investment (GFCF): [sdg_08_11](https://ec.europa.eu/eurostat/databrowser/view/sdg_08_11/default/table)

## Replication Code

The complete R code for this analysis is available in the accompanying `.Rmd` file. All results are fully reproducible using the Eurostat API.

## Export Data for Poster

```{r export-rds}
# Save data and models for poster visualization
dir.create("rds", showWarnings = FALSE)
saveRDS(panel_data, "rds/panel_data.rds")
saveRDS(fe_model, "rds/fe_model.rds")
saveRDS(re_model, "rds/re_model.rds")

cat("Exported files for poster:\n")
cat("- rds/panel_data.rds (", nrow(panel_data), " observations)\n", sep = "")
cat("- rds/fe_model.rds (Fixed Effects model)\n")
cat("- rds/re_model.rds (Random Effects model)\n")
```